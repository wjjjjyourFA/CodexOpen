### 四元数表示法

geometry_msgs/Quaternion quat

本文档消息采用 欧拉角表示，为了解决欧拉角的缺陷，在程序中自己转四元数处理。



**Warning** 在本codex中只存在一个 map 和 多个odom

  不再支持旧*UGV_2024*的 *global__pose* 和 *local_pose*

## 🚗 典型的坐标系层级结构（tf tree）

在 ROS 和自动驾驶系统中，常见结构如下：

```
map         <-- GPS / SLAM 提供全局定位
  |
  └── odom  <-- odometry / imu / lidar-based tracking
        |
        └── base_link  <-- 车辆本体
              └── sensor_xxx  <-- 各传感器
```

- `map → odom`：这个变换是由**定位模块（GNSS、SLAM）**给出的。
- `odom → base_link`：这个变换是由**里程计推算（odom）**给出的。



## 📌 为什么 `odom` 不等于 GPS 坐标？

- `odom` 是一个**局部、连续、无跳变的坐标系**，便于做局部跟踪和滤波（如 EKF、滑动窗口）。
- `odom` 会因 IMU 漂移或里程误差慢慢偏离真实位置。
- `gps` 提供的是**全局坐标**，但更新率低、不连续、跳变大，难以直接用于短时推理。

------



## 🎯 实际用法建议：

- 感知/融合模块：使用 **冻结局部 `odom` 坐标系** 数据，保证一致性。
- 建图/导航模块：使用 **`map` 或 `utm`**，对齐实际地理位置。
- 如果你要将 `odom` 对齐到 `map`，需要通过定位模块提供的 **`map → odom`** 的变换。





## ✅ yaw（更推荐在机器人/无人车中使用）

**右手坐标系，顺时针转正值**

| 名称   | yaw                                      |
| ------ | ---------------------------------------- |
| 中文   | 偏航角                                   |
| 语义   | 欧拉角之一，表示物体绕 Z 轴的旋转        |
| 坐标系 | 通常在车体坐标或世界坐标中使用           |
| 单位   | 弧度（rad）或角度（deg）                 |
| 应用   | 机器人、自动驾驶、飞行器的朝向控制中常用 |
| 例子   | `yaw = 0.5 rad` 表示车头偏右 0.5 弧度    |

**推荐使用场景**：如果你是表示**车体、传感器或目标物体的姿态角（欧拉角）**，比如配合 `pitch`、`roll`，**建议用 `yaw`**。
 → 更标准、统一、好解析。

------

## ✅ azimuth（更偏“方位角”/地理方向）

**地理坐标系，逆时针转正值**

| 名称   | azimuth                                                  |
| ------ | -------------------------------------------------------- |
| 中文   | 方位角                                                   |
| 语义   | 表示目标相对某参考方向（如正北）的角度（通常在水平面上） |
| 坐标系 | 地理坐标、导航地图中使用多                               |
| 单位   | 一般是角度（degree）                                     |
| 应用   | GNSS、雷达目标方向、地图导航                             |
| 例子   | `azimuth = 90°` 表示正东方向                             |

**推荐使用场景**：如果你表示**雷达目标方位、地理朝向、地图方向角**，建议用 `azimuth`。



✅ GPS / Odom 中推荐用 azimuth  
✅ 相反，在 IMU、姿态解算、车体运动学里 yaw # 欧拉角的 Z 轴旋转，绕垂直轴 ✅